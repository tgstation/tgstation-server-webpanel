"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[3890],{3890:function(e,t,r){r.r(t);var s=r(6540),a=r(5615),n=r(1105),i=r(1208),o=r(8065),l=r(4180),c=r(5301),u=r(1552),h=r(7864),m=r(664),d=r(7567),p=r(7255);class E extends s.Component{constructor(e){super(e),this.state={errors:[],password1:"",password2:"",username:"",sysuser:""},this.submitTGS=this.submitTGS.bind(this),this.submitSYS=this.submitSYS.bind(this)}validate(){let e=!1;return this.state.password1.length<this.context.serverInfo.minimumPasswordLength?(e=!0,this.setState({lengthError:!0})):this.setState({lengthError:!1}),this.state.password2!==this.state.password1?(e=!0,this.setState({matchError:!0})):this.setState({matchError:!1}),e}async submitTGS(e){if(e.preventDefault(),this.validate())return;if(!this.state.username)return;this.setState({creating:!0});const t=await u.A.createUser({name:this.state.username,password:this.state.password1});t.code==c.s.OK?this.props.postCreateAction(t.payload,this.props.history):(this.addError(t.error),this.setState({creating:!1}))}async submitSYS(e){if(e.preventDefault(),!this.state.sysuser)return;this.setState({creating:!0});const t=await u.A.createUser({systemIdentifier:this.state.sysuser});t.code==c.s.OK?this.props.postCreateAction(t.payload,this.props.history):(this.addError(t.error),this.setState({creating:!1}))}addError(e){this.setState((t=>{const r=Array.from(t.errors);return r.push(e),{errors:r}}))}render(){if(this.state.creating)return s.createElement(p.default,{text:"loading.user.create"});return s.createElement("div",{className:"text-center"},this.state.errors.map(((e,t)=>{if(e)return s.createElement(d.Ay,{key:t,error:e,onClose:()=>this.setState((e=>{const r=Array.from(e.errors);return r[t]=void 0,{errors:r}}))})})),s.createElement("h3",null,s.createElement(o.A,{id:"routes.usercreate"})),s.createElement(n.A,{className:"mx-auto",lg:5,md:8},s.createElement(i.A,{onSubmit:e=>{this.submitTGS(e)}},s.createElement(i.A.Group,{controlId:"username"},s.createElement(i.A.Label,null,s.createElement(o.A,{id:"login.username"})),s.createElement(i.A.Control,{required:!0,onChange:e=>this.setState({username:e.target.value}),value:this.state.username})),s.createElement(i.A.Group,{controlId:"password1"},s.createElement(i.A.Label,null,s.createElement(o.A,{id:"login.password"})),s.createElement(i.A.Control,{type:"password",onChange:e=>this.setState({password1:e.target.value}),value:this.state.password1,isInvalid:this.state.matchError||this.state.lengthError}),s.createElement(i.A.Control.Feedback,{type:"invalid"},this.state.lengthError?s.createElement(s.Fragment,null,s.createElement(o.A,{id:"login.password.repeat.short"}),this.context.serverInfo.minimumPasswordLength):"")),s.createElement(i.A.Group,{controlId:"password2"},s.createElement(i.A.Label,null,s.createElement(o.A,{id:"login.password.repeat"})),s.createElement(i.A.Control,{type:"password",onChange:e=>this.setState({password2:e.target.value}),value:this.state.password2,isInvalid:this.state.matchError||this.state.lengthError}),s.createElement(i.A.Control.Feedback,{type:"invalid"},this.state.matchError?s.createElement(o.A,{id:"login.password.repeat.match"}):"")),s.createElement(a.A,{type:"submit"},s.createElement(o.A,{id:"view.user.create.tgs"}))),s.createElement("hr",null),s.createElement(i.A,{onSubmit:e=>{this.submitSYS(e)}},s.createElement(i.A.Group,{controlId:"sysuser"},s.createElement(i.A.Label,null,s.createElement(o.A,{id:"generic.systemidentifier"})),s.createElement(i.A.Control,{required:!0,onChange:e=>this.setState({sysuser:e.target.value}),value:this.state.sysuser})),s.createElement(a.A,{type:"submit"},s.createElement(o.A,{id:"view.user.create.sys"})))))}}E.defaultProps={postCreateAction:(e,t)=>{m.M2.selecteduserid=e.id,t.push(m.Sb.useredit.link??m.Sb.useredit.route)}},E.contextType=h.U,t.default=(0,l.y)(E)}}]);
//# sourceMappingURL=3890.6529a4c45b981840fcb6.bundle.js.map