(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[179],{3652:function(e,t,n){"use strict";var r=n(67294),o=n(35005),i=n(44012),a=n(5977),c=n(53041);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},f(e,t)}function d(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(y,e);var t,n,a,s,m=(a=y,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(a);if(s){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return d(this,e)});function y(){return l(this,y),m.apply(this,arguments)}return t=y,(n=[{key:"render",value:function(){var e=this;return r.createElement(c.Z,{title:"generic.accessdenied"},r.createElement(o.Z,{variant:"danger",className:"float-right",onClick:function(){e.props.history.goBack()}},r.createElement(i.Z,{id:"generic.goback"})))}}])&&u(t.prototype,n),y}(r.Component);t.Z=(0,a.EN)(m)},43307:function(e,t,n){"use strict";n.d(t,{ZP:function(){return b},hP:function(){return E},iT:function(){return g}});var r=n(28359),o=n(67294),i=n(88375),a=n(35005),c=n(37959),s=n(44012),l=n(36800),u=n(2486);function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t){return y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},y(e,t)}function h(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}var b=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(b,e);var t,n,f,d,p=(f=b,d=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=v(f);if(d){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return h(this,e)});function b(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,b),(t=p.call(this,e)).state={popup:!1},t}return t=b,(n=[{key:"render",value:function(){var e,t,n=this;if(!this.props.error)return"";var f=function(){return n.setState({popup:!1})};return o.createElement(i.Z,{className:"clearfix",variant:"error",dismissible:!!this.props.onClose,onClose:this.props.onClose},o.createElement(s.Z,{id:this.props.error.code}),o.createElement("hr",null),o.createElement(a.Z,{variant:"danger",className:"float-right",onClick:function(){return n.setState({popup:!0})}},o.createElement(s.Z,{id:"generic.details"})),o.createElement(c.Z,{centered:!0,show:this.state.popup,onHide:f,size:"lg"},o.createElement(c.Z.Header,{closeButton:!0},o.createElement(c.Z.Title,null,o.createElement(s.Z,{id:this.props.error.code}))),o.createElement(c.Z.Body,{className:"text-danger pb-0"},(null===(e=this.props.error.desc)||void 0===e?void 0:e.type)==l._T.LOCALE?o.createElement(s.Z,{id:this.props.error.desc.desc}):null!==(t=this.props.error.desc)&&void 0!==t&&t.desc?this.props.error.desc.desc:"",o.createElement("hr",null),o.createElement(r.Z,null,o.createElement("code",{className:"bg-darker d-block pre-wrap p-2 pre-scrollable"},"Webpanel Version: ".concat(u.q4,"\nWebpanel Mode: ").concat(u.IK,"\nAPI Version: ").concat(u.Gn,"\n\nError Code: ").concat(this.props.error.code,"\nError Description: ").concat(this.props.error.desc?this.props.error.desc.desc:"No description","\n\nAdditional Information:\n").concat(this.props.error.extendedInfo).replace(/\\/g,"\\\\")))),o.createElement(c.Z.Footer,null,o.createElement("span",{className:"font-italic mr-auto"},o.createElement(s.Z,{id:"generic.debugwarn"})),o.createElement(a.Z,{variant:"secondary",onClick:f},o.createElement(s.Z,{id:"generic.close"})))))}}])&&m(t.prototype,n),b}(o.Component);function g(e,t){(0,d(e,2)[1])((function(e){var n=Array.from(e);return n.push(t),n}))}function E(e){var t=d(e,2),n=t[0],r=t[1];return n.map((function(e,t){if(e)return o.createElement(b,{key:t,error:e,onClose:function(){return r((function(e){var n=Array.from(e);return n[t]=void 0,n}))}})}))}},53041:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(67294),o=n(88375),i=n(44012);function a(e){return r.createElement(o.Z,{className:"clearfix",variant:"error"},r.createElement(i.Z,{id:e.title}),e.body?r.createElement(r.Fragment,null,r.createElement("hr",null),r.createElement(i.Z,{id:e.body})):e.children?r.createElement(r.Fragment,null,r.createElement("hr",null),e.children):null)}},33543:function(e,t,n){"use strict";n.d(t,{Z:function(){return A}});var r=n(67814),o=n(67294),i=n(35005),a=n(15293),c=n(51479),s=n(10729),l=n(61318),u=n(17863),f=n(43489),d=n(44012),p=n(48272),m=n(48155);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}var h=["ref"],v=["ref"],b=["ref"],g=["ref"];function E(){return E=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},E.apply(this,arguments)}function w(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t){return S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},S(e,t)}function Z(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function C(e){return C=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},C(e)}var A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(x,e);var t,n,y,A,k=(y=x,A=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=C(y);if(A){var n=C(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Z(this,e)});function x(){return I(this,x),k.apply(this,arguments)}return t=x,(n=[{key:"render",value:function(){var e,t=this,n=this.props.job,y=new Date(n.startedAt),I=(y.getTime()-Date.now())/1e3,O=(new Date(null!==(e=n.stoppedAt)&&void 0!==e?e:0).getTime()-Date.now())/1e3,S=void 0!==n.errorCode||void 0!==n.exceptionDetails?"danger":n.cancelled?"warning":n.stoppedAt?"success":"info";return o.createElement(s.Z,{className:"mx-auto",key:n.id,style:{maxWidth:this.props.width},onClose:function(){t.props.onClose&&t.props.onClose(n)}},o.createElement(u.Z,{closeButton:!!n.stoppedAt&&!!this.props.onClose,className:"bg-".concat(S)},"#",n.id,": ",n.description),o.createElement(l.Z,{className:"pt-0"},n.stage?o.createElement("div",{className:"mb-2"},"â–¶",n.stage):null,o.createElement(d.Z,{id:"app.job.started"}),o.createElement(a.Z,{overlay:o.createElement(f.Z,{id:"".concat(n.id,"-tooltip-started")},y.toLocaleString())},(function(e){var t=e.ref,n=w(e,h);return o.createElement("span",E({},n,{ref:t}),o.createElement(p.Z,{value:I,numeric:"auto",updateIntervalInSeconds:1}))})),o.createElement("br",null),o.createElement(d.Z,{id:"app.job.startedby"}),o.createElement(a.Z,{overlay:o.createElement(f.Z,{id:"".concat(n.id,"-tooltip-startedby")},o.createElement(d.Z,{id:"generic.userid"}),n.startedBy.id)},(function(e){var t=e.ref,r=w(e,v);return o.createElement("span",E({ref:t},r),n.startedBy.name)})),o.createElement("br",null),o.createElement("br",null),n.stoppedAt?o.createElement(o.Fragment,null,o.createElement(d.Z,{id:"app.job.stopped"}),o.createElement(a.Z,{overlay:o.createElement(f.Z,{id:"".concat(n.id,"-tooltip-stopped")},y.toLocaleString())},(function(e){var t=e.ref,n=w(e,b);return o.createElement("span",E({},n,{ref:t}),o.createElement(p.Z,{value:O,numeric:"auto",updateIntervalInSeconds:1}))})),o.createElement("br",null)):"",n.cancelledBy?o.createElement(o.Fragment,null,o.createElement(d.Z,{id:"app.job.stoppedby"}),o.createElement(a.Z,{overlay:o.createElement(f.Z,{id:"".concat(n.id,"-tooltip-createdby")},o.createElement(d.Z,{id:"generic.userid"}),n.startedBy.id)},(function(e){var t=e.ref,r=w(e,g);return o.createElement("span",E({ref:t},r),n.cancelledBy.name)})),o.createElement("br",null)):"",!n.stoppedAt&&!n.cancelledBy||void 0===n.errorCode&&void 0===n.exceptionDetails?"":o.createElement("br",null),void 0!==n.errorCode||void 0!==n.exceptionDetails?o.createElement(o.Fragment,null,o.createElement("span",null,o.createElement(d.Z,{id:"view.instance.jobs.error"}),"(",void 0!==n.errorCode&&null!==n.errorCode?m.jK[n.errorCode]:"NoCode","): ",n.exceptionDetails),o.createElement("br",null)):"",o.createElement("div",{className:"d-flex mt-2",style:{height:"1.5rem"}},o.createElement(c.Z,{className:"text-darker font-weight-bold flex-grow-1 h-unset",animated:!n.stoppedAt,label:"number"==typeof n.progress?"".concat(n.progress.toString(),"%"):void 0,now:"number"==typeof n.progress?n.progress:100,striped:!0,variant:S}),n.canCancel&&!n.stoppedAt?o.createElement(i.Z,{style:{padding:"0 1em"},className:"ml-1",variant:"danger",onClick:function(){return t.props.onCancel(n)}},o.createElement(r.G,{icon:"times",className:"d-block"})):null)))}}])&&O(t.prototype,n),x}(o.Component)},31151:function(e,t,n){"use strict";n.d(t,{Z:function(){return k}});var r=n(67294),o=n(15293),i=n(43489),a=n(44012),c=n(61090),s=n(15402),l=n(38592),u=n(7205),f=n(71460),d=n(43307),p=n(33543),m=n(71739);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function h(){return h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h.apply(this,arguments)}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(e,t)||g(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e){return function(e){if(Array.isArray(e))return E(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||g(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){if(e){if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(e,t):void 0}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function I(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){w(i,r,o,a,c,"next",e)}function c(e){w(i,r,o,a,c,"throw",e)}a(void 0)}))}}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t){return S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},S(e,t)}function Z(e,t){if(t&&("object"===y(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return C(e)}function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(P,e);var t,n,y,E,w,k,x,j=(k=P,x=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=A(k);if(x){var n=A(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return Z(this,e)});function P(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,P),(t=j.call(this,e)).widgetRef=r.createRef(),t.handleUpdate=t.handleUpdate.bind(C(t)),t.onCancel=t.onCancel.bind(C(t)),t.onClose=t.onClose.bind(C(t)),t.state={jobs:f.Z.jobsByInstance,errors:[],ownerrors:[],loading:!0,instances:new Map},t}return t=P,n=[{key:"addError",value:function(e){var t=this;this.setState((function(n){var r=Array.from(n.ownerrors);return r.push(e),t.widgetRef.current&&(t.widgetRef.current.scrollTop=0),{ownerrors:r}}))}},{key:"componentDidMount",value:(w=I((function*(){f.Z.on("jobsLoaded",this.handleUpdate),yield this.handleUpdate()})),function(){return w.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){f.Z.removeListener("jobsLoaded",this.handleUpdate)}},{key:"handleUpdate",value:(E=I((function*(){var e=[],t=yield s.Z.listInstances({pageSize:100});if(t.code!==l.G.ERROR){e.push.apply(e,b(t.payload.content));for(var n=2;n<=t.payload.totalPages;n++){var r=yield s.Z.listInstances({page:n,pageSize:100});if(r.code===l.G.ERROR)return void this.addError(r.error);e.push.apply(e,b(r.payload.content))}var o=new Map;e.forEach((function(e){return o.set(e.id,e)})),this.setState({jobs:f.Z.jobsByInstance,errors:f.Z.errors,loading:!1,instances:o})}else this.addError(t.error)})),function(){return E.apply(this,arguments)})},{key:"onCancel",value:(y=I((function*(e){var t=this;(yield f.Z.cancelJob(e.id,(function(e){return t.addError(e)})))&&(f.Z.fastmode=5)})),function(e){return y.apply(this,arguments)})},{key:"onClose",value:function(e){f.Z.clearJob(e.id)}},{key:"render",value:function(){if(!this.props.widget)return this.nested();var e,t,n=0,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=g(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}(this.state.jobs.values());try{for(o.s();!(e=o.n()).done;)n+=e.value.size}catch(e){o.e(e)}finally{o.f()}return t=u.ZP.jobswidgetdisplay.value!==u.zQ.NEVER&&(u.ZP.jobswidgetdisplay.value===u.zQ.ALWAYS||n>0||this.state.errors.length>0),r.createElement("div",{style:{position:"fixed",top:0,bottom:0,right:0,left:0,pointerEvents:"none"}},r.createElement(c.s,{className:"jobswidget ".concat(t?"":"invisible"),style:{pointerEvents:"auto",bottom:0,right:0},default:{width:"30vw",height:"50vh",x:document.documentElement.clientWidth-Math.min(.3*document.documentElement.clientWidth,350)-20,y:document.documentElement.clientHeight-.5*document.documentElement.clientHeight-20},maxWidth:350,minHeight:50,minWidth:110,bounds:"parent"},r.createElement("div",{className:"fancyscroll overflow-auto h-100",ref:this.widgetRef},r.createElement("h5",{className:"text-center text-darker font-weight-bold"},r.createElement(a.Z,{id:"view.instance.jobs.title"})),this.nested())))}},{key:"nested",value:function(){var e=this;return r.createElement("div",{className:this.props.widget?"d-sm-block":""},this.state.loading?r.createElement(m.Z,{text:"loading.instance.jobs.list"}):"",this.state.ownerrors.map((function(t,n){if(t)return r.createElement(d.ZP,{key:n,error:t,onClose:function(){return e.setState((function(e){var t=Array.from(e.ownerrors);return t[n]=void 0,{ownerrors:t}}))}})})),this.state.errors.map((function(t,n){return r.createElement("div",{key:n,style:{maxWidth:e.props.widget?350:"unset"}},r.createElement(d.ZP,{error:t}))})),Array.from(this.state.jobs).sort((function(e,t){return e[0]-t[0]})).map((function(t){var n,c,s=v(t,2),l=s[0],u=s[1];return r.createElement(r.Fragment,{key:l},r.createElement("div",{className:"bg-dark p-2 text-center"},r.createElement(o.Z,{overlay:function(e){return function(t){return r.createElement(i.Z,h({id:"tooltip-instance-".concat(e)},t),e)}}(l)},r.createElement(r.Fragment,null,null!==(n=null===(c=e.state.instances.get(l))||void 0===c?void 0:c.name)&&void 0!==n?n:"Unknown"," ","(",r.createElement(a.Z,{id:"view.instance.jobs.jobtotal",values:{amount:u.size}}),")"))),Array.from(u,(function(e){return v(e,2)[1]})).sort((function(e,t){return t.id-e.id})).map((function(t){return r.createElement(p.Z,{job:t,width:e.props.width,key:t.id,onClose:e.onClose,onCancel:e.onCancel})})))})))}}],n&&O(t.prototype,n),P}(r.Component);k.defaultProps={widget:!0}},71739:function(e,t,n){"use strict";n.d(t,{Z:function(){return y}});var r=n(67294),o=n(36968),i=n(44012),a=n(29697),c=n(94537);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}var l=["variant","animation","center","className","width","widthUnit","text","children"];function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function p(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(v,e);var t,n,s,y,h=(s=v,y=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(s);if(y){var n=m(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function v(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),h.call(this,e)}return t=v,(n=[{key:"render",value:function(){var e=this.props,t=e.variant,n=e.animation,s=e.center,f=e.className,d=e.width,p=e.widthUnit,m=e.text,y=e.children,h=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,l),v={width:"".concat(d).concat(p),height:"".concat(d).concat(p)};return r.createElement(c.Z,null,r.createElement(a.Z,{appear:!0,classNames:"anim-fade",addEndListener:function(e,t){e.addEventListener("transitionend",t,!1)}},r.createElement("div",{className:s?"text-center":""},r.createElement(o.Z,u({variant:t||"secondary",className:s?"d-block mx-auto ".concat(null!=f?f:""):f,style:v,animation:n||"border"},h)),m?r.createElement(i.Z,{id:m}):"",y)))}}])&&f(t.prototype,n),v}(r.Component);y.defaultProps={animation:"border",width:"50",widthUnit:"vmin",center:!0}},63136:function(e,t,n){"use strict";n.r(t);var r=n(16566),o=n(38658),i=n(67814),a=n(67294),c=n(35005),s=n(31555),l=n(15881),u=n(32258),f=n(44012),d=n(5977),p=n(48155),m=n(39248),y=n(36800),h=n(38592),v=n(65022),b=n(26011),g=n(32826),E=n(44870),w=n(89991),I=n(3429),O=n(43307),S=n(71739);function Z(e){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z(e)}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function A(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function k(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){A(i,r,o,a,c,"next",e)}function c(e){A(i,r,o,a,c,"throw",e)}a(void 0)}))}}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t){return j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},j(e,t)}function P(e,t){if(t&&("object"===Z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _(e)}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(N,e);var t,n,d,g,Z,A,T,L=(A=N,T=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=R(A);if(T){var n=R(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return P(this,e)});function N(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,N),(t=L.call(this,e)).submit=t.submit.bind(_(t)),console.log(I.Mq.oautherrors),t.state={busy:!1,validated:!1,username:"",password:"",errors:Array.from(I.Mq.oautherrors)},t}return t=N,n=[{key:"componentDidMount",value:function(){}},{key:"tryLoginDefault",value:(Z=k((function*(){(yield v.Z.login({type:m.P.Password,userName:"admin",password:"ISolemlySwearToDeleteTheDataDirectory"})).code===h.G.OK&&this.setState({redirectSetup:!0})})),function(){return Z.apply(this,arguments)})},{key:"addError",value:function(e){this.setState((function(t){var n=Array.from(t.errors);return n.push(e),{errors:n}}))}},{key:"render",value:function(){var e,t,n,d,m,y,h,v,g,I,Z=this;if(this.state.busy||b.Z.isTokenValid())return a.createElement(S.Z,{text:"loading.login"});if(!this.context.serverInfo)return a.createElement(S.Z,{text:"loading.serverinfo"});var A=(C(e={},p.O4.GitHub,a.createElement(i.G,{icon:o.zh,style:{width:"1.2em"}})),C(e,p.O4.Discord,a.createElement(i.G,{icon:r.om,style:{width:"1.2em"}})),C(e,p.O4.TGForums,a.createElement("img",{src:w,alt:"tglogo",style:{width:"1.2em"}})),C(e,p.O4.Keycloak,a.createElement("img",{src:E,alt:"keycloaklogo",style:{width:"1.2em"}})),e),k={GitHub:"#161b22",Discord:"#7289da",TGForums:void 0,Keycloak:void 0};return a.createElement(s.Z,{className:"mx-auto",lg:5,md:8},this.state.errors.map((function(e,t){if(e)return a.createElement(O.ZP,{key:t,error:e,onClose:function(){return Z.setState((function(e){var n=Array.from(e.errors);return n[t]=void 0,{errors:n}}))}})})),a.createElement(l.Z,{body:!0},a.createElement(l.Z.Title,null,a.createElement(f.Z,{id:"login.header"})),a.createElement(l.Z,{body:!0},a.createElement(l.Z.Title,null,a.createElement(f.Z,{id:"login.type.generic"})),a.createElement(u.Z,{validated:this.state.validated,onSubmit:this.submit},a.createElement(u.Z.Group,{controlId:"username"},a.createElement(u.Z.Label,null,a.createElement(f.Z,{id:"login.username"})),a.createElement(u.Z.Control,{type:"text",placeholder:"Enter username",onChange:function(e){return Z.setState({username:e.target.value})},value:this.state.username,required:!0})),a.createElement(u.Z.Group,{controlId:"password"},a.createElement(u.Z.Label,null,a.createElement(f.Z,{id:"login.password"})),a.createElement(u.Z.Control,{type:"password",placeholder:"Password",onChange:function(e){return Z.setState({password:e.target.value})},value:this.state.password,required:!0})),a.createElement(c.Z,{type:"submit",block:!0},a.createElement(f.Z,{id:"login.submit"})))),((null===(t=this.context.serverInfo)||void 0===t||null===(n=t.oAuthProviderInfos)||void 0===n?void 0:n.Discord)||(null===(d=this.context.serverInfo)||void 0===d||null===(m=d.oAuthProviderInfos)||void 0===m?void 0:m.GitHub)||(null===(y=this.context.serverInfo)||void 0===y||null===(h=y.oAuthProviderInfos)||void 0===h?void 0:h.Keycloak)||(null===(v=this.context.serverInfo)||void 0===v||null===(g=v.oAuthProviderInfos)||void 0===g?void 0:g.TGForums))&&a.createElement(a.Fragment,null,a.createElement("hr",null),a.createElement(l.Z,{body:!0},a.createElement(l.Z.Title,null,a.createElement(f.Z,{id:"login.type.oauth"})),Object.keys(null!==(I=this.context.serverInfo.oAuthProviderInfos)&&void 0!==I?I:{}).map((function(e){var t=k[e];return a.createElement(c.Z,{key:e,block:!0,style:t?{background:t}:void 0,onClick:function(){return Z.startOAuth(e)}},A[e],a.createElement("span",{className:"ml-1"},a.createElement(f.Z,{id:"login.oauth",values:{provider:e}})))}))))))}},{key:"startOAuth",value:(g=k((function*(e){var t;if(this.context.serverInfo){var n=new Uint8Array(10);window.crypto.getRandomValues(n);var r=Array.from(n,(function(e){return e.toString(16).padStart(2,"0")})).join(""),o=void 0,i=encodeURIComponent;switch(e){case p.O4.Discord:o="https://discord.com/api/oauth2/authorize?response_type=code&client_id=".concat(i(this.context.serverInfo.oAuthProviderInfos.Discord.clientId),"&scope=identify&state=").concat(i(r),"&redirect_uri=").concat(i(this.context.serverInfo.oAuthProviderInfos.Discord.redirectUri));break;case p.O4.GitHub:o="https://github.com/login/oauth/authorize?client_id=".concat(i(this.context.serverInfo.oAuthProviderInfos.GitHub.clientId),"&redirect_uri=").concat(i(this.context.serverInfo.oAuthProviderInfos.GitHub.redirectUri),"&state=").concat(i(r),"&allow_signup=false");break;case p.O4.Keycloak:o="".concat(this.context.serverInfo.oAuthProviderInfos.Keycloak.serverUrl,"/protocol/openid-connect/auth?response_type=code&client_id=").concat(i(this.context.serverInfo.oAuthProviderInfos.Keycloak.clientId),"&scope=openid&state=").concat(i(r),"&redirect_uri=").concat(i(this.context.serverInfo.oAuthProviderInfos.Keycloak.redirectUri));break;case p.O4.TGForums:o="https://tgstation13.org/phpBB/oauth.php?session_public_token=".concat(i(this.context.serverInfo.oAuthProviderInfos.TGForums.clientId))}var a=JSON.parse(null!==(t=window.sessionStorage.getItem("oauth"))&&void 0!==t?t:"{}");return e===p.O4.TGForums?a.tgforums={provider:e,url:this.props.location.pathname,state:this.context.serverInfo.oAuthProviderInfos.TGForums.clientId}:a[r]={provider:e,url:this.props.location.pathname},window.sessionStorage.setItem("oauth",JSON.stringify(a)),window.location.href=o,new Promise((function(e){return e()}))}this.addError(new y.ZP(y.jK.APP_FAIL,{jsError:Error("serverInfo is null in startOAuth")}))})),function(e){return g.apply(this,arguments)})},{key:"submit",value:(d=k((function*(e){e.preventDefault(),this.setState({busy:!0});var t=yield v.Z.login({type:m.P.Password,userName:this.state.username,password:this.state.password});t.code==h.G.ERROR?(this.setState({busy:!1}),this.addError(t.error)):this.props.postLoginAction&&this.props.postLoginAction()})),function(e){return d.apply(this,arguments)})}],n&&x(t.prototype,n),N}(a.Component);T.contextType=g.f,t.default=(0,d.EN)(T)},32826:function(e,t,n){"use strict";n.d(t,{f:function(){return r}});var r=n(67294).createContext(void 0)},2486:function(e,t,n){"use strict";n.d(t,{Gn:function(){return r},q4:function(){return o},IK:function(){return i},UG:function(){return a},cV:function(){return c}});var r="9.3.0",o="ea2fdaef7c9f49ed3c9896a64be1f57356b6644c",i="GITHUB",a="/app/",c="/"},71173:function(e,t,n){"use strict";n(51340),n(75029),n(5547),n(74462),n(17689);var r=n(67294),o=n(73935),i=n(42078),a=n(71460),c=n(93379),s=n.n(c),l=n(39087),u=(s()(l.Z,{insert:"head",singleton:!1}),l.Z.locals,n(88375)),f=n(10682),d=n(44012),p=n(29558),m=n(73727),y=n(39248),h=n(36800),v=n(38592),b=n(65022),g=n(69644),E=n(26011),w=n(34477),I=n(67814),O=n(35005),S=n(75040),Z=n(13361),C=n(103),A=n(5977),k=n(29697),x=n(32826),j=n(42540),P=n(23926),_=n(3429);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function T(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e,t){return N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},N(e,t)}function G(e,t){if(t&&("object"===R(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return U(e)}function U(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e){return B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},B(e)}var D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(l,e);var t,n,o,i,a,c,s=(a=l,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=B(a);if(c){var n=B(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return G(this,e)});function l(e){var t,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),(r=s.call(this,e)).logoutClick=r.logoutClick.bind(U(r)),r.loginSuccess=r.loginSuccess.bind(U(r)),r.logout=r.logout.bind(U(r)),r.refresh=r.refresh.bind(U(r)),r.state={loggedIn:!!E.Z.isTokenValid(),routes:[],categories:_.Nz,focusedCategory:null!==(t=null===(n=r.props.category)||void 0===n?void 0:n.name)&&void 0!==t?t:""},r}return t=l,n=[{key:"loginSuccess",value:function(){this.setState({loggedIn:!0})}},{key:"logout",value:function(){this.setState({loggedIn:!1})}},{key:"refresh",value:function(e){this.setState({routes:e})}},{key:"componentDidMount",value:(o=function*(){w.Z.on("loginSuccess",this.loginSuccess),b.Z.on("logout",this.logout),this.setState({routes:yield P.Z.getRoutes()}),P.Z.on("refresh",this.refresh)},i=function(){var e=this,t=arguments;return new Promise((function(n,r){var i=o.apply(e,t);function a(e){T(i,n,r,a,c,"next",e)}function c(e){T(i,n,r,a,c,"throw",e)}a(void 0)}))},function(){return i.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){w.Z.removeListener("loginSuccess",this.loginSuccess),b.Z.removeListener("logout",this.logout),P.Z.removeListener("refresh",this.refresh)}},{key:"componentDidUpdate",value:function(e){var t;void 0!==this.props.category&&this.props.category.key!==(null===(t=e.category)||void 0===t?void 0:t.key)&&this.setState({focusedCategory:this.props.category.name})}},{key:"render",value:function(){var e=this;return r.createElement(r.Fragment,null,r.createElement(C.Z,{className:"shadow-lg",expand:this.state.loggedIn?"lg":void 0,collapseOnSelect:!0,variant:"dark",bg:"primary"},r.createElement(C.Z.Brand,{onClick:function(){var t;e.props.history.push(null!==(t=_.$w.home.link)&&void 0!==t?t:_.$w.home.route,{reload:!0})},className:"mr-auto"},this.renderVersion()),r.createElement(C.Z.Toggle,{className:"mr-2","aria-controls":"responsive-navbar-nav"}),r.createElement(C.Z.Collapse,{className:"text-right mr-2",style:{minWidth:"0px"}},r.createElement(Z.Z,{className:"mr-auto overflow-auto fancyscroll"},this.state.loggedIn?Object.values(this.state.categories).map((function(t){if(t.leader.cachedAuth)return r.createElement("div",{key:t.name,className:"d-flex",onMouseEnter:function(){var n=window.setTimeout((function(){e.setState({focusedCategory:t.name,focusTimer:void 0})}),130);e.setState({focusTimer:n})},onMouseLeave:function(){window.clearTimeout(e.state.focusTimer),e.setState({focusTimer:void 0})},onClick:function(){window.clearTimeout(e.state.focusTimer),e.setState({focusedCategory:t.name,focusTimer:void 0})}},r.createElement(Z.Z.Item,null,r.createElement(Z.Z.Link,{onClick:function(){var n;e.props.history.push(null!==(n=t.leader.link)&&void 0!==n?n:t.leader.route,{reload:!0})},active:(0,j.JW)(e.props.location.pathname,t.leader.route,!t.leader.navbarLoose)},r.createElement(d.Z,{id:t.leader.name}))),Object.values(t.routes).filter((function(e){return e.cachedAuth})).length>=2?r.createElement(k.Z,{in:e.state.focusedCategory===t.name,classNames:"anim-collapse",className:"nowrap anim-collapse-all",addEndListener:function(e,t){e.addEventListener("transitionend",t,!1)},onMouseEnter:function(){e.setState({focusedCategory:t.name})}},r.createElement("div",null,r.createElement(Z.Z,null,r.createElement("div",{className:"py-2 d-none d-lg-inline"},r.createElement(I.G,{icon:"angle-right"})),r.createElement(Z.Z,{className:"bg-darkblue mx-1 rounded"},t.routes.map((function(t){if(!t.catleader&&t.cachedAuth&&t.visibleNavbar)return r.createElement(Z.Z.Item,{key:t.name},r.createElement(Z.Z.Link,{onClick:function(){var n;e.props.history.push(null!==(n=t.link)&&void 0!==n?n:t.route,{reload:!0})},active:(0,j.JW)(e.props.location.pathname,t.route,!t.navbarLoose)},r.createElement(d.Z,{id:t.name})))})),r.createElement("div",{className:"py-2 d-none d-lg-inline mr-1"},r.createElement(I.G,{icon:"grip-lines-vertical"})))))):"")})):r.createElement(Z.Z.Item,null,r.createElement(Z.Z.Link,{onClick:function(){var t;e.props.history.push(null!==(t=_.$w.home.link)&&void 0!==t?t:_.$w.home.route,{reload:!0})},active:!0},r.createElement(d.Z,{id:"routes.login"})))),this.renderUser())))}},{key:"renderVersion",value:function(){var e;return null!==(e=this.context.serverInfo)&&void 0!==e&&e.version?r.createElement(r.Fragment,null,r.createElement(d.Z,{id:"generic.appname"})," v",this.context.serverInfo.version):r.createElement(d.Z,{id:"loading.loading"})}},{key:"renderUser",value:function(){var e=this;return this.state.loggedIn?r.createElement(Z.Z.Item,{className:"ml-auto"},r.createElement(S.Z,null,r.createElement(S.Z.Toggle,{id:"user-dropdown",type:"button",variant:"primary","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},this.context.user?this.context.user.name:r.createElement(d.Z,{id:"loading.loading"})),r.createElement(S.Z.Menu,{alignRight:!0,className:"text-right"},r.createElement(S.Z.Item,{onClick:function(){var t;e.props.history.push(null!==(t=_.$w.info.link)&&void 0!==t?t:_.$w.info.route,{reload:!0})}},r.createElement(d.Z,{id:"routes.info"})),r.createElement(S.Z.Item,{onClick:function(){var t;e.props.history.push(null!==(t=_.$w.config.link)&&void 0!==t?t:_.$w.config.route,{reload:!0})}},r.createElement(d.Z,{id:"routes.config"})),_.$w.passwd.cachedAuth?r.createElement(S.Z.Item,{onClick:function(){var t;e.props.history.push(null!==(t=_.$w.passwd.link)&&void 0!==t?t:_.$w.passwd.route,{reload:!0})}},r.createElement(d.Z,{id:"routes.passwd"})):"",r.createElement(S.Z.Item,{onClick:function(){b.Z.emit("purgeCache"),e.props.history.replace(e.props.location.pathname,{reload:!0})}},r.createElement(d.Z,{id:"navbar.purgecache"})),r.createElement(S.Z.Item,{onClick:function(){e.props.history.replace(e.props.location.pathname,{reload:!0})}},r.createElement(d.Z,{id:"navbar.refresh"})),r.createElement(S.Z.Item,{onClick:this.logoutClick},r.createElement(d.Z,{id:"navbar.logout"}))))):r.createElement(r.Fragment,null,r.createElement(O.Z,{onClick:function(){var t;e.props.history.push(null!==(t=_.$w.config.link)&&void 0!==t?t:_.$w.config.route,{reload:!0})},variant:"primary"},r.createElement(I.G,{icon:"cogs"})),r.createElement(O.Z,{onClick:function(){var t;e.props.history.push(null!==(t=_.$w.info.link)&&void 0!==t?t:_.$w.info.route,{reload:!0})},variant:"primary"},r.createElement(I.G,{icon:"info-circle"})))}},{key:"logoutClick",value:function(){b.Z.logout()}}],n&&L(t.prototype,n),l}(r.Component);D.contextType=x.f;var M=(0,A.EN)(D),F=n(43307),$=n(15881),z=n(2486);function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function H(e,t){return H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},H(e,t)}function V(e,t){if(t&&("object"===K(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function J(e){return J=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},J(e)}var q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}(c,e);var t,n,o,i,a=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=J(o);if(i){var n=J(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return V(this,e)});function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=a.call(this,e)).state={},t}return t=c,(n=[{key:"componentDidUpdate",value:function(e){this.props.location.key!==e.location.key&&this.setState({error:void 0,errorInfo:void 0})}},{key:"componentDidCatch",value:function(e,t){this.setState({error:e,errorInfo:t})}},{key:"render",value:function(){var e,t;return this.state.error?r.createElement(f.Z,{className:"mt-5 mb-5"},r.createElement($.Z,{className:"bg-transparent",border:"danger"},r.createElement($.Z.Header,{className:"bg-danger"},r.createElement(d.Z,{id:"error.somethingwentwrong"})),r.createElement($.Z.Body,null,r.createElement($.Z.Title,null,this.state.error.name,": ",this.state.error.message),r.createElement($.Z.Text,{as:"pre",className:"bg-transparent text-danger"},r.createElement("code",null,"Webpanel Version: ".concat(z.q4,"\nWebpanel Mode: ").concat(z.IK,"\nStack trace: ").concat(null!==(e=null===(t=this.state.errorInfo)||void 0===t?void 0:t.componentStack)&&void 0!==e?e:"Unable to get stack info")))))):this.props.children}}])&&W(t.prototype,n),c}(r.Component),X=(0,A.EN)(q),Y=n(31151),Q=n(71739),ee=n(40684),te=n(48155),ne=n(3652);function re(e){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re(e)}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ie(e,t){return ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ie(e,t)}function ae(e,t){if(t&&("object"===re(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ce(e){return ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ce(e)}var se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ie(e,t)}(a,e);var t,n,r,o,i=(r=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ce(r);if(o){var n=ce(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return ae(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={clear:!1},t}return t=a,(n=[{key:"componentDidUpdate",value:function(e){var t;this.state.clear?this.setState({clear:!1}):e.match.path==this.props.match.path&&e.location.key!=this.props.location.key&&null!==(t=this.props.location.state)&&void 0!==t&&t.reload&&this.setState({clear:!0})}},{key:"render",value:function(){return this.state.clear?"":this.props.children}}])&&oe(t.prototype,n),a}(r.Component),le=(0,A.EN)(se),ue=n(63136);function fe(e){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe(e)}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pe(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ye(e,t){return ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ye(e,t)}function he(e,t){if(t&&("object"===fe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ve(e)}function ve(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function be(e){return be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},be(e)}var ge=function(e){return r.createElement(Q.Z,{text:"loading.page"},r.createElement(d.Z,{id:e}))},Ee=(0,ee.ZP)((function(){return n.e(486).then(n.bind(n,13486))}),{fallback:ge("loading.page.notfound")}),we=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(u,e);var t,o,i,a,c,s,l=(c=u,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=be(c);if(s){var n=be(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return he(this,e)});function u(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=l.call(this,e)).refreshListener=t.refreshListener.bind(ve(t));var r=new Map;return P.Z.getImmediateRoutes(!1).forEach((function(e){r.set(e.name,(0,ee.ZP)((function(){return n(66235)("./".concat(e.file))}),{fallback:ge(e.name)}))})),t.state={loading:!!new URLSearchParams(window.location.search).get("state"),routes:P.Z.getImmediateRoutes(!1),components:r},t}return t=u,o=[{key:"refreshListener",value:function(e){this.setState({routes:e})}},{key:"componentDidMount",value:(i=function*(){var e,t=this;P.Z.on("refreshAll",this.refreshListener),this.props.history.listen((function(e){t.listener(e.pathname)})),this.listener(this.props.location.pathname);var n=new URLSearchParams(window.location.search),r=n.get("state");if(r){var o=JSON.parse(null!==(e=window.sessionStorage.getItem("oauth"))&&void 0!==e?e:"{}")[r];if(!o)return this.setErrorAndEnd(new h.ZP(h.jK.LOGIN_BAD_OAUTH,{jsError:Error("State(".concat(r,") cannot be resolved to a provider."))}));var i=n.get("code");if(o.provider===te.O4.TGForums&&(i=o.state),!i)return this.setErrorAndEnd(new h.ZP(h.jK.LOGIN_BAD_OAUTH,{jsError:Error("Code not found.")}));this.props.history.replace(o.url);var a=yield b.Z.login({type:y.P.OAuth,provider:o.provider,token:i});if(a.code!==v.G.OK)return this.setErrorAndEnd(a.error);this.setState({loading:!1})}else this.setState({loading:!1})},a=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){pe(o,n,r,a,c,"next",e)}function c(e){pe(o,n,r,a,c,"throw",e)}a(void 0)}))},function(){return a.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){P.Z.removeListener("refreshAll",this.refreshListener)}},{key:"setErrorAndEnd",value:function(e){_.Mq.oautherrors=[e],this.setState({loading:!1})}},{key:"listener",value:function(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return de(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?de(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}(P.Z.getImmediateRoutes(!1));try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.category&&r.navbarLoose&&(0,j.JW)(e,r.route)){this.props.selectCategory(r.category);break}}}catch(e){n.e(e)}finally{n.f()}}},{key:"render",value:function(){var e=this;return this.state.loading?r.createElement(Q.Z,{text:"loading.app"}):r.createElement(X,null,r.createElement(le,null,r.createElement("div",null,r.createElement(A.rs,null,this.state.routes.map((function(t){if(t.loginless||e.props.loggedIn)return r.createElement(A.AW,{exact:!t.loose,path:t.route,key:t.name,render:function(n){var o,i,a;return a=t.cachedAuth?e.state.components.get(t.name):ne.Z,null!==(o=e.context)&&void 0!==o&&o.user||t.loginless?null!==(i=e.context)&&void 0!==i&&i.serverInfo||t==_.$w.config?t.noContainer?r.createElement(r.Fragment,null,r.createElement(a,n)):r.createElement(f.Z,{className:"mt-5 mb-5"},r.createElement(a,n)):r.createElement(f.Z,null,r.createElement(F.ZP,{error:new h.ZP(h.jK.APP_FAIL,{jsError:Error("Router has no server info in the general context")})})):r.createElement(f.Z,null,r.createElement(F.ZP,{error:new h.ZP(h.jK.APP_FAIL,{jsError:Error("Router has no user in the general context")})}))}})})),r.createElement(f.Z,{className:"mt-5 mb-5"},r.createElement(A.AW,{key:"notfound"},this.props.loggedIn?r.createElement(Ee,null):r.createElement(ue.default,null)))))))}}],o&&me(t.prototype,o),u}(r.Component);we.contextType=x.f;var Ie=(0,A.EN)(we),Oe=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)};Oe.en="en";var Se=Oe,Ze=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.locale=t,this.messages=n};function Ce(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function Ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ke=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o,i,a;return t=e,r=[{key:"loadTranslation",value:(i=function*(t){var r=yield n(862)("./".concat(t,".json"));if(!r){var o=e.getShortHandedLocale(t);if(o===t){if(o===e.fallbackLocale)throw new Error("Invalid locale: "+t);o=e.fallbackLocale}return yield this.loadTranslation(o)}var i=null;try{i=new Ze(t,r)}catch(e){throw Error("Error loading localization for locale '".concat(t,"': ").concat(JSON.stringify(e)))}return i},a=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=i.apply(e,t);function a(e){Ce(o,n,r,a,c,"next",e)}function c(e){Ce(o,n,r,a,c,"throw",e)}a(void 0)}))},function(e){return a.apply(this,arguments)})}],o=[{key:"getShortHandedLocale",value:function(e){return e.split("-")[0]}}],r&&Ae(t.prototype,r),o&&Ae(t,o),e}();ke.fallbackLocale=Se.en;var xe=ke;function je(e){return je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},je(e)}function Pe(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function _e(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){Pe(i,r,o,a,c,"next",e)}function c(e){Pe(i,r,o,a,c,"throw",e)}a(void 0)}))}}function Re(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Te(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ne(e,t,n){return t&&Le(e.prototype,t),n&&Le(e,n),e}function Ge(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ue(e,t)}function Ue(e,t){return Ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ue(e,t)}function Be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Fe(e);if(t){var o=Fe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return De(this,n)}}function De(e,t){if(t&&("object"===je(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Me(e)}function Me(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fe(e){return Fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Fe(e)}var $e=function(e){Ge(n,e);var t=Be(n);function n(e){var r;return Te(this,n),(r=t.call(this,e)).state={},r}return Ne(n,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",(function(e){"L"==e.key&&e.ctrlKey&&e.shiftKey&&(b.Z.logout(),b.Z.login({type:y.P.Password,userName:"admin",password:"ISolemlySwearToDeleteTheDataDirectory"}))}))}},{key:"render",value:function(){var e,t=this;return r.createElement(m.VK,{basename:z.UG},r.createElement(X,null,r.createElement(M,{category:this.state.passdownCat}),this.props.loading?r.createElement(f.Z,{className:"mt-5 mb-5"},r.createElement(Q.Z,{text:"loading.app"})):r.createElement(r.Fragment,null,r.createElement(f.Z,{className:"mt-5"},r.createElement(u.Z,{variant:"warning",className:"d-block d-lg-none"},r.createElement(u.Z.Heading,null,r.createElement(d.Z,{id:"warning.screensize.header"})),r.createElement("hr",null),r.createElement(d.Z,{id:"warning.screensize"})),(e=this.context.errors.values(),function(e){if(Array.isArray(e))return Re(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return Re(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Re(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map((function(e,n){return r.createElement(F.ZP,{error:e,key:n,onClose:function(){return t.context.deleteError(e)}})}))),r.createElement(Ie,{loggedIn:this.props.loggedIn,selectCategory:function(e){t.setState({passdownCat:{name:e,key:Math.random().toString()}})}})),this.props.loggedIn?r.createElement(Y.Z,null):null))}}]),n}(r.Component);$e.contextType=x.f;var ze=function(e){Ge(c,e);var t,n,o,i,a=Be(c);function c(e){var t,n;return Te(this,c),(n=a.call(this,e)).translationFactory=void 0,n.finishLogin=n.finishLogin.bind(Me(n)),n.finishLogout=n.finishLogout.bind(Me(n)),n.updateContextUser=n.updateContextUser.bind(Me(n)),n.updateContextServer=n.updateContextServer.bind(Me(n)),n.deleteGeneralContextError=n.deleteGeneralContextError.bind(Me(n)),n.translationFactory=null!==(t=n.props.translationFactory)&&void 0!==t?t:new xe,n.state={loggedIn:!!E.Z.isTokenValid(),loading:!0,GeneralContextInfo:{errors:new Set,user:null,serverInfo:null,deleteError:n.deleteGeneralContextError}},n}return Ne(c,[{key:"updateContextUser",value:(i=_e((function*(){var e=this,t=yield g.Z.getCurrentUser();t.code===v.G.OK?this.setState((function(e){return{GeneralContextInfo:{errors:e.GeneralContextInfo.errors,user:t.payload,serverInfo:e.GeneralContextInfo.serverInfo,deleteError:e.GeneralContextInfo.deleteError}}})):t.error.code===h.jK.HTTP_ACCESS_DENIED?this.setState((function(e){return{GeneralContextInfo:{user:null,serverInfo:e.GeneralContextInfo.serverInfo,deleteError:e.GeneralContextInfo.deleteError,errors:e.GeneralContextInfo.errors}}})):(setTimeout((function(){e.updateContextUser()}),5e3),this.setState((function(e){var n=new Set(e.GeneralContextInfo.errors);return n.add(t.error),{GeneralContextInfo:{errors:n,deleteError:e.GeneralContextInfo.deleteError,user:null,serverInfo:e.GeneralContextInfo.serverInfo}}})))})),function(){return i.apply(this,arguments)})},{key:"updateContextServer",value:(o=_e((function*(){var e=this,t=yield b.Z.getServerInfo();t.code===v.G.OK?this.setState((function(e){return{GeneralContextInfo:{errors:e.GeneralContextInfo.errors,user:e.GeneralContextInfo.user,serverInfo:t.payload,deleteError:e.GeneralContextInfo.deleteError}}})):(setTimeout((function(){e.updateContextServer()}),5e3),this.setState((function(e){var n=new Set(e.GeneralContextInfo.errors);return n.add(t.error),{GeneralContextInfo:{errors:n,deleteError:e.GeneralContextInfo.deleteError,user:e.GeneralContextInfo.user,serverInfo:null}}})))})),function(){return o.apply(this,arguments)})},{key:"deleteGeneralContextError",value:function(e){this.setState((function(t){var n=new Set(t.GeneralContextInfo.errors);return n.delete(e),{GeneralContextInfo:{deleteError:t.GeneralContextInfo.deleteError,user:t.GeneralContextInfo.user,serverInfo:t.GeneralContextInfo.serverInfo,errors:n}}}))}},{key:"finishLogin",value:function(){console.log("Logging in"),g.Z.getCurrentUser(),this.updateContextUser(),this.setState({loggedIn:!0,loading:!1})}},{key:"finishLogout",value:function(){this.setState({loggedIn:!1}),this.updateContextUser()}},{key:"componentDidMount",value:(n=_e((function*(){w.Z.on("loginSuccess",this.finishLogin),b.Z.on("logout",this.finishLogout),b.Z.on("purgeCache",this.updateContextServer),b.Z.on("purgeCache",this.updateContextUser),yield this.loadTranslation(),yield b.Z.initApi(),yield this.updateContextServer(),this.setState({loading:!1})})),function(){return n.apply(this,arguments)})},{key:"componentWillUnmount",value:function(){w.Z.removeListener("loginSuccess",this.finishLogin),b.Z.removeListener("logout",this.finishLogout),b.Z.removeListener("purgeCache",this.updateContextServer),b.Z.removeListener("purgeCache",this.updateContextUser)}},{key:"render",value:function(){return null!=this.state.translationError?r.createElement("p",{className:"App-error"},this.state.translationError):null==this.state.translation?r.createElement(Q.Z,null,"Loading translations..."):r.createElement(p.Z,{locale:this.state.translation.locale,messages:this.state.translation.messages},r.createElement(x.f.Provider,{value:this.state.GeneralContextInfo},r.createElement($e,{loading:this.state.loading,loggedIn:this.state.loggedIn})))}},{key:"loadTranslation",value:(t=_e((function*(){console.time("LoadTranslations");try{var e=yield this.translationFactory.loadTranslation(this.props.locale);this.setState({translation:e})}catch(e){var t;return void this.setState({translationError:null!==(t=JSON.stringify(e))&&void 0!==t?t:"An unknown error occurred"})}console.timeEnd("LoadTranslations")})),function(){return t.apply(this,arguments)})}]),c}(r.Component),Ke=ze,We=n(78947),He=n(51417),Ve=n(66370),Je=n(83183),qe=n(68055),Xe=n(24075),Ye=n(47810),Qe=n(57026),et=n(20702),tt=n(8792),nt=n(9752),rt=n(19500),ot=n(51257),it=n(16688),at=n(68099),ct=n(82414),st=n(84176),lt=n(62679),ut=n(609),ft=n(7371),dt=n(40098),pt=n(16995),mt=n(95337),yt=n(59986),ht=n(5702),vt=n(91883),bt=n(59545),gt=n(55554),Et=n(42619),wt=n(40864),It=n(27879),Ot=n(46357),St=n(27593);We.vI.add(qe.LE,bt.NB,et.RL,It.IL,St.wO,ot.vc,vt.UO,dt.r8,pt.Ps,it.J9,gt.Cg,Ye.Kb,wt.X7,at.YH,nt._3,Je.yO,st.DD,ft.Iw,He.zhw,He.omb,Et.$,ct.sq,Ve.Pd,rt.ne,lt.gf,Qe.lX,tt.cC,Ot.FV,Xe.mh,mt.wn,yt.xf,ht.aC,ut.by),i.Z.loadconfig(),a.Z.init(),window.loadedChannelFromWebpack&&"DEV"!==z.IK&&alert("Warning: channel.json was served from bundled files instead of TGS, the webpanel is running from the local version instead of the github update repo.\nPlease report this to your server host.\nIf you are the server host, please report this to alexkar598#2712 on discord\n\nWebpanel version: "+z.q4);try{window.localStorage.removeItem("username"),window.sessionStorage.removeItem("username"),window.localStorage.removeItem("password"),window.sessionStorage.removeItem("password")}catch(e){}var Zt=document.getElementById("root"),Ct=r.createElement(r.StrictMode,null,r.createElement(Ke,{locale:Se.en}));(0,o.render)(Ct,Zt)},23926:function(e,t,n){"use strict";var r=n(12527),o=n(34477),i=n(3429);function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function c(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){c(i,r,o,a,s,"next",e)}function s(e){c(i,r,o,a,s,"throw",e)}a(void 0)}))}}function l(e,t){if(e){if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},d(e,t)}function p(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return m(e)}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(v,e);var t,n,r,a,c,u,h=(c=v,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=y(c);if(u){var n=y(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return p(this,e)});function v(){var e,t,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,v),(e=h.call(this)).refreshing=!1,window.rtcontroller=m(e),e.refreshRoutes=e.refreshRoutes.bind(m(e)),o.Z.addHook(e.refreshRoutes),e.refreshRoutes().catch(console.error),console.time("Category mapping");for(var r=new Map,a=0,c=Object.entries(i.XT);a<c.length;a++){var s=(t=c[a],n=2,function(e){if(Array.isArray(e))return e}(t)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,c=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(c)throw o}}return i}}(t,n)||l(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),u=s[0],f=s[1];f.routes=[],r.set(f.name,f),i.Nz[u]=f}for(var d=0,p=Object.values(i.$w);d<p.length;d++){var y=p[d];if(y.category){var b=r.get(y.category);if(b){if(b.routes.push(y),y.catleader){if(b.leader){console.error("Category has two leaders",b.leader,y);continue}b.leader=y}}else console.error("Route has invalid category",y)}}return console.log("Categories mapped",r),console.timeEnd("Category mapping"),e}return t=v,n=[{key:"refreshRoutes",value:(a=s((function*(){if(!this.refreshing){this.refreshing=!0;var e,t=[],n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=l(e))){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}(this.getImmediateRoutes(!1));try{var r=function(){var n=e.value;n.cachedAuth=void 0,n.isAuthorized?t.push(n.isAuthorized().then((function(e){n.cachedAuth=e}))):n.cachedAuth=!0};for(n.s();!(e=n.n()).done;)r()}catch(e){n.e(e)}finally{n.f()}yield Promise.all(t),this.emit("refresh",this.getImmediateRoutes(!0));var o=this.getImmediateRoutes(!1);return this.emit("refreshAll",o),this.refreshing=!1,console.log("Routes refreshed",o),yield this.getRoutes()}console.log("Already refreshing")})),function(){return a.apply(this,arguments)})},{key:"wait4refresh",value:function(){var e=this;return new Promise((function(t){e.refreshing?e.on("refresh",(function(){t()})):t()}))}},{key:"getRoutes",value:(r=s((function*(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return yield this.wait4refresh(),this.getImmediateRoutes(e)})),function(){return r.apply(this,arguments)})},{key:"getImmediateRoutes",value:function(){for(var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=[],n=0,r=Object.values(i.$w);n<r.length;n++){var o=r[n];o.isAuthorized&&!o.cachedAuth&&e||t.push(o)}return t}}],n&&f(t.prototype,n),v}(r.TypedEmitter);t.Z=new h},42540:function(e,t,n){"use strict";n.d(t,{LR:function(){return o},ko:function(){return i},JW:function(){return a},Zg:function(){return c},n5:function(){return u},D0:function(){return l},mg:function(){return f}});var r=n(51068);function o(e,t){var n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(t)),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}function i(e,t,n,r){return e.replace(new RegExp(t.replace(/([/,!\\^${}[\]().*+?|<>\-&])/g,"\\$&"),r?"gi":"g"),n.replace(/\$/g,"$$$$"))}function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return"/"===e.slice(-1)&&(e=e.slice(0,-1)),"/"===t.slice(-1)&&(t=t.slice(0,-1)),(0,r.Bo)(t,void 0,{end:n}).test(e)}function c(e){var t,n;return null!==(t=e.permissionSet)&&void 0!==t?t:null===(n=e.group)||void 0===n?void 0:n.permissionSet}function s(e,t){return!!(t&e)}function l(e,t){return s(e.instanceManagerRights,t)}function u(e,t){return s(e.byondRights,t)}function f(e,t){return s(e.dreamDaemonRights,t)}},3429:function(e,t,n){"use strict";n.d(t,{$w:function(){return d},XT:function(){return p},Nz:function(){return m},Mq:function(){return y}});var r=n(48155),o=n(38592),i=n(69644),a=n(26011),c=n(42540);function s(e,t,n,r,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void n(e)}c.done?t(s):Promise.resolve(s).then(r,o)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){s(i,r,o,a,c,"next",e)}function c(e){s(i,r,o,a,c,"throw",e)}a(void 0)}))}}function u(e){return l((function*(){if(!a.Z.isTokenValid())return!1;var t=yield i.Z.getCurrentUser();return t.code==o.G.OK&&!!((0,c.Zg)(t.payload).administrationRights&e)}))}function f(e){return l((function*(){if(!a.Z.isTokenValid())return!1;var t=yield i.Z.getCurrentUser();return t.code==o.G.OK&&!!((0,c.Zg)(t.payload).instanceManagerRights&e)}))}var d={home:{name:"routes.home",route:"/",file:"Home",loose:!1,navbarLoose:!1,visibleNavbar:!0,homeIcon:void 0,category:"home",catleader:!0},instancecreate:{name:"routes.instancecreate",route:"/instances/create",file:"Instance/Create",loose:!1,navbarLoose:!1,isAuthorized:f(r.c2.Create),visibleNavbar:!1,category:"instance",catleader:!1},instancelist:{name:"routes.instancelist",route:"/instances/",file:"Instance/List",loose:!1,navbarLoose:!0,isAuthorized:f(r.c2.List|r.c2.Read),visibleNavbar:!0,homeIcon:"hdd",category:"instance",catleader:!0},instanceedit:{name:"routes.instanceedit",route:"/instances/edit/:id(\\d+)/:tab?/",file:"Instance/InstanceEdit",get link(){var e;return void 0!==y.selectedinstanceid?"/instances/edit/".concat(y.selectedinstanceid,"/").concat(void 0!==y.selectedinstanceedittab?"".concat(y.selectedinstanceedittab,"/"):""):null!==(e=d.instancelist.link)&&void 0!==e?e:d.instancelist.route},loose:!1,navbarLoose:!0,visibleNavbar:!0,homeIcon:void 0,category:"instance"},instancejobs:{name:"routes.instancejobs",route:"/instances/jobs/",file:"Instance/Jobs",loose:!1,navbarLoose:!0,visibleNavbar:!0,homeIcon:void 0,category:"instance"},userlist:{name:"routes.usermanager",route:"/users/",file:"User/List",loose:!1,navbarLoose:!0,visibleNavbar:!0,homeIcon:"user",category:"user",catleader:!0},useredit:{name:"routes.useredit",route:"/users/edit/user/:id(\\d+)/:tab?/",get link(){var e;return void 0!==y.selecteduserid?"/users/edit/user/".concat(y.selecteduserid,"/").concat(void 0!==y.selectedusertab?"".concat(y.selectedusertab,"/"):""):null!==(e=d.userlist.link)&&void 0!==e?e:d.userlist.route},file:"User/Edit",loose:!0,navbarLoose:!0,visibleNavbar:!0,homeIcon:void 0,category:"user"},usercreate:{name:"routes.usercreate",route:"/users/create/",link:"/users/create/",file:"User/Create",loose:!0,navbarLoose:!0,isAuthorized:u(r.oj.WriteUsers),visibleNavbar:!0,homeIcon:void 0,category:"user"},admin:{name:"routes.admin",route:"/admin/",file:"Administration",loose:!1,navbarLoose:!0,isAuthorized:u(r.oj.ChangeVersion),visibleNavbar:!0,homeIcon:"tools",category:"admin",catleader:!0},admin_update:{name:"routes.admin.update",route:"/admin/update/:all?/",file:"Admin/Update",link:"/admin/update/",loose:!0,navbarLoose:!0,isAuthorized:u(r.oj.ChangeVersion),visibleNavbar:!0,homeIcon:void 0,category:"admin"},admin_logs:{name:"routes.admin.logs",route:"/admin/logs/:name?/",link:"/admin/logs/",file:"Admin/Logs",loose:!1,navbarLoose:!0,isAuthorized:u(r.oj.DownloadLogs),visibleNavbar:!0,homeIcon:void 0,category:"admin",noContainer:!0},passwd:{name:"routes.passwd",route:"/users/passwd/:id(\\d+)?/",link:"/users/passwd/",file:"ChangePassword",loose:!0,navbarLoose:!0,isAuthorized:u(r.oj.EditOwnPassword),visibleNavbar:!1,homeIcon:"key"},config:{name:"routes.config",route:"/config/",file:"Configuration",loose:!0,navbarLoose:!0,loginless:!0,visibleNavbar:!1,homeIcon:"cogs"},setup:{name:"routes.setup",route:"/setup/",file:"Setup",loose:!0,navbarLoose:!0,loginless:!0,visibleNavbar:!1},oAuth:{name:"routes.oauth",route:"/oauth/:provider?/",file:"Login",loose:!0,navbarLoose:!1,loginless:!0,visibleNavbar:!1},info:{name:"routes.info",route:"/info",file:"Info",loose:!1,navbarLoose:!1,loginless:!0,visibleNavbar:!0,homeIcon:"info-circle",category:void 0,catleader:!1}},p={home:{name:"home"},instance:{name:"instance"},user:{name:"user"},admin:{name:"admin"}},m={},y={selecteduserid:void 0,selectedusertab:void 0,selectedinstanceid:void 0,selectedinstanceedittab:void 0,instancelistpage:void 0,loglistpage:void 0,byondlistpage:void 0,userlistpage:void 0,jobhistorypage:new Map,oautherrors:[]}},39087:function(e,t,n){"use strict";var r=n(94015),o=n.n(r),i=n(23645),a=n.n(i),c=n(61667),s=n.n(c),l=n(31100),u=a()(o()),f=s()(l);u.push([e.id,".App {\n    background-size: 50%;\n    background: #1e1e1e url("+f+") no-repeat center;\n    position: absolute;\n    width: 100%;\n    top: 0;\n    bottom: 0;\n    display: grid;\n}\n\n.App-error {\n    color: red;\n    font-size: 150%;\n    margin: auto;\n}\n\n.App-main {\n    display: grid;\n}\n\n.Root {\n    overflow: hidden;\n    display: grid;\n    grid-template-rows: 9% auto;\n}\n\n.Root-login {\n    display: grid;\n}\n","",{version:3,sources:["webpack://./src/App.css"],names:[],mappings:"AAAA;IACI,oBAAoB;IACpB,4EAAkD;IAClD,kBAAkB;IAClB,WAAW;IACX,MAAM;IACN,SAAS;IACT,aAAa;AACjB;;AAEA;IACI,UAAU;IACV,eAAe;IACf,YAAY;AAChB;;AAEA;IACI,aAAa;AACjB;;AAEA;IACI,gBAAgB;IAChB,aAAa;IACb,2BAA2B;AAC/B;;AAEA;IACI,aAAa;AACjB",sourcesContent:[".App {\n    background-size: 50%;\n    background: #1e1e1e url(logo.svg) no-repeat center;\n    position: absolute;\n    width: 100%;\n    top: 0;\n    bottom: 0;\n    display: grid;\n}\n\n.App-error {\n    color: red;\n    font-size: 150%;\n    margin: auto;\n}\n\n.App-main {\n    display: grid;\n}\n\n.Root {\n    overflow: hidden;\n    display: grid;\n    grid-template-rows: 9% auto;\n}\n\n.Root-login {\n    display: grid;\n}\n"],sourceRoot:""}]),t.Z=u},66235:function(e,t,n){var r={"./Admin/Logs":[90105,233,820,171,105],"./Admin/Logs.tsx":[90105,233,820,171,105],"./Admin/Update":[98628,233,820,171,909,628],"./Admin/Update.tsx":[98628,233,820,171,909,628],"./Administration":[11680,233,820,171,680],"./Administration.tsx":[11680,233,820,171,680],"./ChangePassword":[83359,359],"./ChangePassword.tsx":[83359,359],"./Configuration":[17273,273],"./Configuration.tsx":[17273,273],"./Home":[64558,558],"./Home.tsx":[64558,558],"./Info":[14464,171,464],"./Info.tsx":[14464,171,464],"./Instance/Create":[79350,350],"./Instance/Create.tsx":[79350,350],"./Instance/Edit/Byond":[59012,233,201,171,12,208],"./Instance/Edit/Byond.tsx":[59012,233,201,171,12,208],"./Instance/Edit/Config":[88964,171,626,964],"./Instance/Edit/Config.tsx":[88964,171,626,964],"./Instance/Edit/JobHistory":[41606,171,606],"./Instance/Edit/JobHistory.tsx":[41606,171,606],"./Instance/Edit/Server":[78883,490,171,626,883],"./Instance/Edit/Server.tsx":[78883,490,171,626,883],"./Instance/InstanceEdit":[63711,233,490,201,171,626,12,883,711],"./Instance/InstanceEdit.tsx":[63711,233,490,201,171,626,12,883,711],"./Instance/Jobs":[50571,571],"./Instance/Jobs.tsx":[50571,571],"./Instance/List":[36228,171,228],"./Instance/List.tsx":[36228,171,228],"./Login":[63136],"./Login.tsx":[63136],"./Setup":[65324,324],"./Setup.tsx":[65324,324],"./User/Create":[57257,257],"./User/Create.tsx":[57257,257],"./User/Edit":[28253,98,171,253],"./User/Edit.tsx":[28253,98,171,253],"./User/List":[11120,171,120],"./User/List.tsx":[11120,171,120]};function o(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],o=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n(o)}))}o.keys=function(){return Object.keys(r)},o.id=66235,e.exports=o},862:function(e,t,n){var r={"./en.json":[2422,422]};function o(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],o=t[0];return n.e(t[1]).then((function(){return n.t(o,19)}))}o.keys=function(){return Object.keys(r)},o.id=862,e.exports=o},44870:function(e){"use strict";e.exports="https://tgstation.github.io/tgstation-server-webpanel/webpanel/2.4.0/995a88a72fd6520c8505.png"},89991:function(e){"use strict";e.exports="https://tgstation.github.io/tgstation-server-webpanel/webpanel/2.4.0/c97e39e417e48a3282f9.svg"},31100:function(e){"use strict";e.exports="https://tgstation.github.io/tgstation-server-webpanel/webpanel/2.4.0/5e166c1106c425ae6fb5.svg"},33471:function(){},52361:function(){},94616:function(){}},function(e){e.O(0,[189,198,340],(function(){return 71173,e(e.s=71173)})),e.O()}]);
//# sourceMappingURL=main.ea8784781a0447474348.js.map