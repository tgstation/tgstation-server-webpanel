"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[898],{14898:function(e,t,r){r.r(t);var s=r(67294),a=r(35005),n=r(31555),i=r(32258),o=r(44012),l=r(5977),c=r(53803),h=r(16942),u=r(44615),m=r(1320),d=r(3e3),p=r(35855);class E extends s.Component{constructor(e){super(e),this.state={errors:[],password1:"",password2:"",username:"",sysuser:""},this.submitTGS=this.submitTGS.bind(this),this.submitSYS=this.submitSYS.bind(this)}validate(){let e=!1;return this.state.password1.length<this.context.serverInfo.minimumPasswordLength?(e=!0,this.setState({lengthError:!0})):this.setState({lengthError:!1}),this.state.password2!==this.state.password1?(e=!0,this.setState({matchError:!0})):this.setState({matchError:!1}),e}async submitTGS(e){if(e.preventDefault(),this.validate())return;if(!this.state.username)return;this.setState({creating:!0});const t=await h.Z.createUser({name:this.state.username,password:this.state.password1});t.code==c.G.OK?this.props.postCreateAction(t.payload,this.props.history):(this.addError(t.error),this.setState({creating:!1}))}async submitSYS(e){if(e.preventDefault(),!this.state.sysuser)return;this.setState({creating:!0});const t=await h.Z.createUser({systemIdentifier:this.state.sysuser});t.code==c.G.OK?this.props.postCreateAction(t.payload,this.props.history):(this.addError(t.error),this.setState({creating:!1}))}addError(e){this.setState((t=>{const r=Array.from(t.errors);return r.push(e),{errors:r}}))}render(){if(this.state.creating)return s.createElement(p.Z,{text:"loading.user.create"});return s.createElement("div",{className:"text-center"},this.state.errors.map(((e,t)=>{if(e)return s.createElement(d.ZP,{key:t,error:e,onClose:()=>this.setState((e=>{const r=Array.from(e.errors);return r[t]=void 0,{errors:r}}))})})),s.createElement("h3",null,s.createElement(o.Z,{id:"routes.usercreate"})),s.createElement(n.Z,{className:"mx-auto",lg:5,md:8},s.createElement(i.Z,{onSubmit:this.submitTGS},s.createElement(i.Z.Group,{controlId:"username"},s.createElement(i.Z.Label,null,s.createElement(o.Z,{id:"login.username"})),s.createElement(i.Z.Control,{required:!0,onChange:e=>this.setState({username:e.target.value}),value:this.state.username})),s.createElement(i.Z.Group,{controlId:"password1"},s.createElement(i.Z.Label,null,s.createElement(o.Z,{id:"login.password"})),s.createElement(i.Z.Control,{type:"password",onChange:e=>this.setState({password1:e.target.value}),value:this.state.password1,isInvalid:this.state.matchError||this.state.lengthError}),s.createElement(i.Z.Control.Feedback,{type:"invalid"},this.state.lengthError?s.createElement(s.Fragment,null,s.createElement(o.Z,{id:"login.password.repeat.short"}),this.context.serverInfo.minimumPasswordLength):"")),s.createElement(i.Z.Group,{controlId:"password2"},s.createElement(i.Z.Label,null,s.createElement(o.Z,{id:"login.password.repeat"})),s.createElement(i.Z.Control,{type:"password",onChange:e=>this.setState({password2:e.target.value}),value:this.state.password2,isInvalid:this.state.matchError||this.state.lengthError}),s.createElement(i.Z.Control.Feedback,{type:"invalid"},this.state.matchError?s.createElement(o.Z,{id:"login.password.repeat.match"}):"")),s.createElement(a.Z,{type:"submit"},s.createElement(o.Z,{id:"view.user.create.tgs"}))),s.createElement("hr",null),s.createElement(i.Z,{onSubmit:this.submitSYS},s.createElement(i.Z.Group,{controlId:"sysuser"},s.createElement(i.Z.Label,null,s.createElement(o.Z,{id:"generic.systemidentifier"})),s.createElement(i.Z.Control,{required:!0,onChange:e=>this.setState({sysuser:e.target.value}),value:this.state.sysuser})),s.createElement(a.Z,{type:"submit"},s.createElement(o.Z,{id:"view.user.create.sys"})))))}}E.defaultProps={postCreateAction:(e,t)=>{m.Mq.selecteduserid=e.id,t.push(m.$w.useredit.link??m.$w.useredit.route)}},E.contextType=u.f,t.default=(0,l.EN)(E)}}]);
//# sourceMappingURL=898.506fa6125431a4f5701d.bundle.js.map