"use strict";(self.webpackChunktgstation_server_control_panel=self.webpackChunktgstation_server_control_panel||[]).push([[3016,6983],{8018:function(e,t,a){a.r(t);var n=a(6540),s=a(6052),i=a(5615),r=a(5038),l=a(3524),o=a(8065),c=a(8798),d=a(9589),m=a(4366),u=a(2576),f=a(5301),p=a(379),v=a(7621),h=a(4118),b=a(9956),w=a(7567),N=a(5659),P=a(1723),E=a(6113),S=a(6795),g=a(7255),A=function(e){return e[e.None=0]="None",e[e.Stop=1]="Stop",e[e.Restart=2]="Restart",e}(A||{});t.default=(0,c.Ay)((function(e){const t=(0,n.useContext)(v.z),[a,c]=(0,n.useState)(),[y,R]=(0,n.useState)(!1),C=(0,n.useState)([]);async function B(){if(!(0,h.GY)(t.instancePermissionSet,u.NB.ReadMetadata))return c({});const e=await m.A.getWatchdogStatus(t.instance.id);e.code===f.s.ERROR?(0,w.CN)(C,e.error):c(e.payload)}async function _(e){R(!0);const a=await m.A.updateWatchdogStatus(t.instance.id,e);a.code===f.s.ERROR&&(0,w.CN)(C,a.error),await B(),R(!1)}if((0,n.useEffect)((()=>{B()}),[t.instance.id]),!a)return n.createElement(n.Fragment,null,(0,w.u9)(C));if(y)return n.createElement(g.default,null);const x={autoStart:{type:P.PU.Boolean,name:"fields.instance.watchdog.autostart",defaultValue:a.autoStart,disabled:!(0,h.GY)(t.instancePermissionSet,u.NB.SetAutoStart)},startProfiler:{type:P.PU.Boolean,name:"fields.instance.watchdog.autostartprofiler",defaultValue:a.startProfiler,disabled:!(0,h.GY)(t.instancePermissionSet,u.NB.SetProfiler)},logOutput:{type:P.PU.Boolean,name:"fields.instance.watchdog.logoutput",defaultValue:a.logOutput,disabled:!(0,h.GY)(t.instancePermissionSet,u.NB.SetLogOutput)},port:{type:P.PU.Number,name:"fields.instance.watchdog.port",defaultValue:a.port,min:0,max:65535,disabled:!(0,h.GY)(t.instancePermissionSet,u.NB.SetPort)},visibility:{type:P.PU.Enum,name:"fields.instance.watchdog.visibility",defaultValue:a.visibility,enum:u.mS,disabled:!(0,h.GY)(t.instancePermissionSet,u.NB.SetVisibility)},securityLevel:{type:P.PU.Enum,name:"fields.instance.watchdog.securitylevel",defaultValue:a.securityLevel,enum:u.GZ,disabled:!(0,h.GY)(t.instancePermissionSet,u.NB.SetSecurity)},startupTimeout:{type:P.PU.Number,name:"fields.instance.watchdog.timeout.startup",defaultValue:a.startupTimeout,min:0,disabled:!(0,h.GY)(t.instancePermissionSet,u.NB.SetStartupTimeout)},topicRequestTimeout:{type:P.PU.Number,name:"fields.instance.watchdog.timeout.topic",defaultValue:a.topicRequestTimeout,min:0,disabled:!(0,h.GY)(t.instancePermissionSet,u.NB.SetTopicTimeout)},healthCheckSeconds:{type:P.PU.Number,name:"fields.instance.watchdog.healthcheck",defaultValue:a.healthCheckSeconds,min:0,disabled:!(0,h.GY)(t.instancePermissionSet,u.NB.SetHealthCheckInterval)},dumpOnHealthCheckRestart:{type:P.PU.Boolean,name:"fields.instance.watchdog.dumpOnHealthCheckRestart",defaultValue:a.dumpOnHealthCheckRestart,disabled:!(0,h.GY)(t.instancePermissionSet,u.NB.CreateDump)},minidumps:{type:P.PU.Boolean,name:"fields.instance.watchdog.minidumps",defaultValue:a.minidumps,disabled:!(0,h.GY)(t.instancePermissionSet,u.NB.SetMinidumps)},allowWebClient:{type:P.PU.Boolean,name:"fields.instance.watchdog.allowwebclient",defaultValue:a.allowWebClient,disabled:!(0,h.GY)(t.instancePermissionSet,u.NB.SetWebClient)},additionalParameters:{type:P.PU.String,name:"fields.instance.watchdog.additionalparams",defaultValue:a.additionalParameters,disabled:!(0,h.GY)(t.instancePermissionSet,u.NB.SetAdditionalParameters)},mapThreads:{type:P.PU.Number,name:"fields.instance.watchdog.mapthreads",defaultValue:a.mapThreads,disabled:!(0,h.GY)(t.instancePermissionSet,u.NB.SetMapThreads)},openDreamTopicPort:{type:P.PU.Number,name:"fields.instance.watchdog.od_topic_port",tooltip:"fields.instance.watchdog.od_topic_port.desc",defaultValue:a.openDreamTopicPort,min:0,max:65535,disabled:!(0,h.GY)(t.instancePermissionSet,u.NB.SetPort)}},G=Object.values(x).some((e=>!e.disabled)),Y=n.createElement(l.A,{id:"generic.no_perm"},n.createElement(o.A,{id:"generic.no_perm"})),U=(0,h.GY)(t.instancePermissionSet,u.NB.Start),k=(0,h.GY)(t.instancePermissionSet,u.NB.Shutdown),O=(0,h.GY)(t.instancePermissionSet,u.NB.Restart),V=(0,h.GY)(t.instancePermissionSet,u.NB.CreateDump),W=(0,h.GY)(t.instancePermissionSet,u.NB.ReadMetadata),T=(0,h.GY)(t.instancePermissionSet,u.NB.SoftShutdown)||(0,h.GY)(t.instancePermissionSet,u.NB.SoftRestart),M=U||k||O||V,L=!(0,h.GY)(t.instancePermissionSet,u.NB.BroadcastMessage)||W&&(a.status!==u._W.Online||null!=a.activeCompileJob?.dmApiVersion&&!(0,d.gte)(a.activeCompileJob?.dmApiVersion,"5.7.0")),D={message:{type:P.PU.String,name:"fields.instance.watchdog.broadcast",defaultValue:"",disabled:L,tooltip:"fields.instance.watchdog.broadcast.desc"}},J=(0,h.GY)(t.instancePermissionSet,u.NB.ReadRevision);let z=null;return a&&(z={viewDataType:b.G.Watchdog,activeCompileJob:a.activeCompileJob,stagedCompileJob:a.stagedCompileJob}),n.createElement("div",{className:"text-center"},n.createElement(S.Q,{obj:a}),(0,w.u9)(C),n.createElement("h2",{className:"text-center"},n.createElement(o.A,{id:"view.instance.server.status"}),n.createElement(s.A,{pill:!0,variant:a.status===u._W.Online?"success":a.status===u._W.Offline?"danger":"warning"},n.createElement(o.A,{id:`view.instance.server.status.${u._W[a.status]}`}))),n.createElement("hr",null),J?n.createElement(b.A,{viewData:z}):n.createElement(N.A,{title:"view.instance.no_compile_jobs"}),n.createElement("hr",null),n.createElement("h3",{className:"text-center"},n.createElement(o.A,{id:"view.instance.server.settings"})),W?null:G?n.createElement(N.A,{title:"view.instance.no_metadata"}):n.createElement(N.A,{title:"view.instance.server.no_metadata_and_no_settings"}),n.createElement(E.A,{fields:x,onSave:_,hideDisabled:!W}),n.createElement("hr",null),n.createElement("h3",{className:"text-center"},n.createElement(o.A,{id:"view.instance.server.actions"})),M?n.createElement(n.Fragment,null,W?null:n.createElement(N.A,{title:"view.instance.server.no_metadata_actions"}),n.createElement("div",{className:"text-center mb-3"},n.createElement(r.A,{overlay:Y,show:!U&&void 0},n.createElement(i.A,{variant:"success",className:"mx-2",onClick:()=>{!async function(){R(!0);const e=await m.A.startWatchdog(t.instance.id);e.code===f.s.ERROR?(0,w.CN)(C,e.error):(p.default.registerCallback(e.payload.id,(()=>{B()})),p.default.fastmode=5,await B()),R(!1)}()},disabled:W&&a.status!=u._W.Offline||!U},n.createElement(o.A,{id:"view.instance.server.start"}))),n.createElement(r.A,{overlay:Y,show:!k&&void 0},n.createElement(i.A,{variant:"danger",className:"mx-2",onClick:()=>{!async function(){if(!confirm(e.intl.formatMessage({id:"view.instance.server.prompt.stop"})))return;R(!0);const a=await m.A.stopWatchdog(t.instance.id);a.code===f.s.ERROR?(0,w.CN)(C,a.error):await B(),R(!1)}()},disabled:W&&a.status==u._W.Offline||!k},n.createElement(o.A,{id:"view.instance.server.stop"}))),n.createElement(r.A,{overlay:Y,show:!O&&void 0},n.createElement(i.A,{variant:"warning",className:"mx-2",onClick:()=>{!async function(){if(!confirm(e.intl.formatMessage({id:"view.instance.server.prompt.restart"})))return;R(!0);const a=await m.A.restartWatchdog(t.instance.id);a.code===f.s.ERROR?(0,w.CN)(C,a.error):(p.default.registerCallback(a.payload.id,(()=>{B()})),p.default.fastmode=5,await B()),R(!1)}()},disabled:W&&a.status==u._W.Offline||!O},n.createElement(o.A,{id:"view.instance.server.restart"}))),n.createElement(r.A,{overlay:Y,show:!V&&void 0},n.createElement(i.A,{variant:"info",className:"mx-2",onClick:()=>{!async function(){R(!0);const e=await m.A.dumpWatchdog(t.instance.id);e.code===f.s.ERROR?(0,w.CN)(C,e.error):p.default.fastmode=5,R(!1)}()},disabled:W&&a.status!=u._W.Online||!V},n.createElement(o.A,{id:"view.instance.server.dump"}))))):n.createElement(N.A,{title:"view.instance.server.no_actions"}),!W&&T?n.createElement(N.A,{title:"view.instance.server.no_metadata_graceful"}):null,W||T?n.createElement("div",{className:"w-75 mx-auto"},n.createElement(P.Ay,{name:"view.instance.graceful",type:P.PU.Enum,enum:A,tooltip:"view.instance.graceful.desc",defaultValue:a.softRestart?A.Restart:a.softShutdown?A.Stop:A.None,disabled:!T,onChange:e=>{switch(e){case A.None:if(!a?.softRestart&&!a?.softShutdown)return;_({softShutdown:!a.softShutdown&&void 0,softRestart:!a.softRestart&&void 0});break;case A.Stop:if(a?.softShutdown)return;_({softShutdown:!0});break;case A.Restart:if(a?.softRestart)return;_({softRestart:!0})}}})):M?n.createElement(N.A,{title:"view.instance.server.no_graceful"}):null,n.createElement("div",{className:"w-75 mx-auto"},n.createElement("br",null),n.createElement(E.A,{fields:D,onSave:e=>{_({broadcastMessage:e.message})},saveMessageId:"view.instance.server.broadcast"})))}))},6052:function(e,t,a){var n=a(8168),s=a(8587),i=a(2485),r=a.n(i),l=a(6540),o=a(6519),c=["bsPrefix","variant","pill","className","as"],d=l.forwardRef((function(e,t){var a=e.bsPrefix,i=e.variant,d=e.pill,m=e.className,u=e.as,f=void 0===u?"span":u,p=(0,s.A)(e,c),v=(0,o.oU)(a,"badge");return l.createElement(f,(0,n.A)({ref:t},p,{className:r()(m,v,d&&v+"-pill",i&&v+"-"+i)}))}));d.displayName="Badge",d.defaultProps={pill:!1},t.A=d},1069:function(e,t,a){a.d(t,{A:function(){return S}});var n=a(8168),s=a(8587),i=a(2485),r=a.n(i),l=a(6540),o=a(6519),c=a(9703),d=["active","disabled","className","style","activeLabel","children"],m=["children"],u=l.forwardRef((function(e,t){var a=e.active,i=e.disabled,o=e.className,m=e.style,u=e.activeLabel,f=e.children,p=(0,s.A)(e,d),v=a||i?"span":c.A;return l.createElement("li",{ref:t,style:m,className:r()(o,"page-item",{active:a,disabled:i})},l.createElement(v,(0,n.A)({className:"page-link",disabled:i},p),f,a&&u&&l.createElement("span",{className:"sr-only"},u)))}));u.defaultProps={active:!1,disabled:!1,activeLabel:"(current)"},u.displayName="PageItem";var f=u;function p(e,t,a){function n(e){var n=e.children,i=(0,s.A)(e,m);return l.createElement(u,i,l.createElement("span",{"aria-hidden":"true"},n||t),l.createElement("span",{className:"sr-only"},a))}return void 0===a&&(a=e),n.displayName=e,n}var v=p("First","\xab"),h=p("Prev","\u2039","Previous"),b=p("Ellipsis","\u2026","More"),w=p("Next","\u203a"),N=p("Last","\xbb"),P=["bsPrefix","className","children","size"],E=l.forwardRef((function(e,t){var a=e.bsPrefix,i=e.className,c=e.children,d=e.size,m=(0,s.A)(e,P),u=(0,o.oU)(a,"pagination");return l.createElement("ul",(0,n.A)({ref:t},m,{className:r()(i,u,d&&u+"-"+d)}),c)}));E.First=v,E.Prev=h,E.Ellipsis=b,E.Item=f,E.Next=w,E.Last=N;var S=E},3899:function(e,t,a){a.d(t,{A:function(){return v}});var n=a(8168),s=a(8587),i=a(2485),r=a.n(i),l=a(6540),o=(a(8239),a(6519)),c=["as","bsPrefix","className","children"],d=l.forwardRef((function(e,t){var a=e.as,i=void 0===a?"div":a,d=e.bsPrefix,m=e.className,u=e.children,f=(0,s.A)(e,c);return d=(0,o.oU)(d,"popover-header"),l.createElement(i,(0,n.A)({ref:t},f,{className:r()(d,m)}),u)})),m=["as","bsPrefix","className","children"],u=l.forwardRef((function(e,t){var a=e.as,i=void 0===a?"div":a,c=e.bsPrefix,d=e.className,u=e.children,f=(0,s.A)(e,m);return c=(0,o.oU)(c,"popover-body"),l.createElement(i,(0,n.A)({ref:t},f,{className:r()(d,c)}),u)})),f=["bsPrefix","placement","className","style","children","content","arrowProps","popper","show"],p=l.forwardRef((function(e,t){var a=e.bsPrefix,i=e.placement,c=e.className,d=e.style,m=e.children,p=e.content,v=e.arrowProps,h=(e.popper,e.show,(0,s.A)(e,f)),b=(0,o.oU)(a,"popover"),w=((null==i?void 0:i.split("-"))||[])[0];return l.createElement("div",(0,n.A)({ref:t,role:"tooltip",style:d,"x-placement":w,className:r()(c,b,w&&"bs-popover-"+w)},h),l.createElement("div",(0,n.A)({className:"arrow"},v)),p?l.createElement(u,null,m):m)}));p.defaultProps={placement:"right"},p.Title=d,p.Content=u;var v=p},2431:function(e,t,a){var n=a(8168),s=a(8587),i=a(2485),r=a.n(i),l=a(6540),o=a(6519),c=["bsPrefix","className","striped","bordered","borderless","hover","size","variant","responsive"],d=l.forwardRef((function(e,t){var a=e.bsPrefix,i=e.className,d=e.striped,m=e.bordered,u=e.borderless,f=e.hover,p=e.size,v=e.variant,h=e.responsive,b=(0,s.A)(e,c),w=(0,o.oU)(a,"table"),N=r()(i,w,v&&w+"-"+v,p&&w+"-"+p,d&&w+"-striped",m&&w+"-bordered",u&&w+"-borderless",f&&w+"-hover"),P=l.createElement("table",(0,n.A)({},b,{className:N,ref:t}));if(h){var E=w+"-responsive";return"string"==typeof h&&(E=E+"-"+h),l.createElement("div",{className:E},P)}return P}));t.A=d}}]);
//# sourceMappingURL=3016.52de61fb4a855c4cfd09.bundle.js.map